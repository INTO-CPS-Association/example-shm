import numpy

def jac(E, nu, r, s, t, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, y1, y2, y3, y4, y5, y6, y7, y8, y9, y10, z1, z2, z3, z4, z5, z6, z7, z8, z9, z10):
    return numpy.array([[-4.0*s*x6 + 4.0*s*x8 + 4.0*t*x10 - 4.0*t*x7 + x1*(4.0*r + 4.0*s + 4.0*t - 3.0) + x2*(4.0*r - 1.0) - x5*(8.0*r + 4.0*s + 4.0*t - 4.0), -4.0*s*y6 + 4.0*s*y8 + 4.0*t*y10 - 4.0*t*y7 + y1*(4.0*r + 4.0*s + 4.0*t - 3.0) + y2*(4.0*r - 1.0) - y5*(8.0*r + 4.0*s + 4.0*t - 4.0), -4.0*s*z6 + 4.0*s*z8 + 4.0*t*z10 - 4.0*t*z7 + z1*(4.0*r + 4.0*s + 4.0*t - 3.0) + z2*(4.0*r - 1.0) - z5*(8.0*r + 4.0*s + 4.0*t - 4.0)], [-4.0*r*x5 + 4.0*r*x8 - 4.0*t*x7 + 4.0*t*x9 + x1*(4.0*r + 4.0*s + 4.0*t - 3.0) + x3*(4.0*s - 1.0) - x6*(4.0*r + 8.0*s + 4.0*t - 4.0), -4.0*r*y5 + 4.0*r*y8 - 4.0*t*y7 + 4.0*t*y9 + y1*(4.0*r + 4.0*s + 4.0*t - 3.0) + y3*(4.0*s - 1.0) - y6*(4.0*r + 8.0*s + 4.0*t - 4.0), -4.0*r*z5 + 4.0*r*z8 - 4.0*t*z7 + 4.0*t*z9 + z1*(4.0*r + 4.0*s + 4.0*t - 3.0) + z3*(4.0*s - 1.0) - z6*(4.0*r + 8.0*s + 4.0*t - 4.0)], [4.0*r*x10 - 4.0*r*x5 - 4.0*s*x6 + 4.0*s*x9 + x1*(4.0*r + 4.0*s + 4.0*t - 3.0) + x4*(4.0*t - 1.0) - x7*(4.0*r + 4.0*s + 8.0*t - 4.0), 4.0*r*y10 - 4.0*r*y5 - 4.0*s*y6 + 4.0*s*y9 + y1*(4.0*r + 4.0*s + 4.0*t - 3.0) + y4*(4.0*t - 1.0) - y7*(4.0*r + 4.0*s + 8.0*t - 4.0), 4.0*r*z10 - 4.0*r*z5 - 4.0*s*z6 + 4.0*s*z9 + z1*(4.0*r + 4.0*s + 4.0*t - 3.0) + z4*(4.0*t - 1.0) - z7*(4.0*r + 4.0*s + 8.0*t - 4.0)]])

def phi(E, nu, r, s, t, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, y1, y2, y3, y4, y5, y6, y7, y8, y9, y10, z1, z2, z3, z4, z5, z6, z7, z8, z9, z10):
    return numpy.array([[2.0*r**2 + 4.0*r*s + 4.0*r*t - 3.0*r + 2.0*s**2 + 4.0*s*t - 3.0*s + 2.0*t**2 - 3.0*t + 1.0], [r*(2.0*r - 1.0)], [s*(2.0*s - 1.0)], [t*(2.0*t - 1.0)], [4.0*r*(-r - s - t + 1)], [4.0*s*(-r - s - t + 1)], [4.0*t*(-r - s - t + 1)], [4.0*r*s], [4.0*s*t], [4.0*r*t]])

def N(E, nu, r, s, t, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, y1, y2, y3, y4, y5, y6, y7, y8, y9, y10, z1, z2, z3, z4, z5, z6, z7, z8, z9, z10):
    return numpy.array([[2.0*r**2 + 4.0*r*s + 4.0*r*t - 3.0*r + 2.0*s**2 + 4.0*s*t - 3.0*s + 2.0*t**2 - 3.0*t + 1.0, 0, 0, r*(2.0*r - 1.0), 0, 0, s*(2.0*s - 1.0), 0, 0, t*(2.0*t - 1.0), 0, 0, 4.0*r*(-r - s - t + 1), 0, 0, 4.0*s*(-r - s - t + 1), 0, 0, 4.0*t*(-r - s - t + 1), 0, 0, 4.0*r*s, 0, 0, 4.0*s*t, 0, 0, 4.0*r*t, 0, 0], [0, 2.0*r**2 + 4.0*r*s + 4.0*r*t - 3.0*r + 2.0*s**2 + 4.0*s*t - 3.0*s + 2.0*t**2 - 3.0*t + 1.0, 0, 0, r*(2.0*r - 1.0), 0, 0, s*(2.0*s - 1.0), 0, 0, t*(2.0*t - 1.0), 0, 0, 4.0*r*(-r - s - t + 1), 0, 0, 4.0*s*(-r - s - t + 1), 0, 0, 4.0*t*(-r - s - t + 1), 0, 0, 4.0*r*s, 0, 0, 4.0*s*t, 0, 0, 4.0*r*t, 0], [0, 0, 2.0*r**2 + 4.0*r*s + 4.0*r*t - 3.0*r + 2.0*s**2 + 4.0*s*t - 3.0*s + 2.0*t**2 - 3.0*t + 1.0, 0, 0, r*(2.0*r - 1.0), 0, 0, s*(2.0*s - 1.0), 0, 0, t*(2.0*t - 1.0), 0, 0, 4.0*r*(-r - s - t + 1), 0, 0, 4.0*s*(-r - s - t + 1), 0, 0, 4.0*t*(-r - s - t + 1), 0, 0, 4.0*r*s, 0, 0, 4.0*s*t, 0, 0, 4.0*r*t]])

def D(E, nu, r, s, t, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, y1, y2, y3, y4, y5, y6, y7, y8, y9, y10, z1, z2, z3, z4, z5, z6, z7, z8, z9, z10):
    return numpy.array([[E*(nu - 1)/(2*nu**2 + nu - 1), -E*nu/(2*nu**2 + nu - 1), -E*nu/(2*nu**2 + nu - 1), 0, 0, 0], [-E*nu/(2*nu**2 + nu - 1), E*(nu - 1)/(2*nu**2 + nu - 1), -E*nu/(2*nu**2 + nu - 1), 0, 0, 0], [-E*nu/(2*nu**2 + nu - 1), -E*nu/(2*nu**2 + nu - 1), E*(nu - 1)/(2*nu**2 + nu - 1), 0, 0, 0], [0, 0, 0, (1/2)*E/(nu + 1), 0, 0], [0, 0, 0, 0, (1/2)*E/(nu + 1), 0], [0, 0, 0, 0, 0, (1/2)*E/(nu + 1)]])

def B(jac_inv11, jac_inv12, jac_inv13, jac_inv21, jac_inv22, jac_inv23, jac_inv31, jac_inv32, jac_inv33, r, s, t):
    return numpy.array([[jac_inv11*(4.0*r + 4.0*s + 4.0*t - 3.0) + jac_inv12*(4.0*r + 4.0*s + 4.0*t - 3.0) + jac_inv13*(4.0*r + 4.0*s + 4.0*t - 3.0), 0, 0, jac_inv11*(4.0*r - 1.0), 0, 0, jac_inv12*(4.0*s - 1.0), 0, 0, jac_inv13*(4.0*t - 1.0), 0, 0, jac_inv11*(-8.0*r - 4.0*s - 4.0*t + 4.0) - 4.0*jac_inv12*r - 4.0*jac_inv13*r, 0, 0, -4.0*jac_inv11*s + jac_inv12*(-4.0*r - 8.0*s - 4.0*t + 4.0) - 4.0*jac_inv13*s, 0, 0, -4.0*jac_inv11*t - 4.0*jac_inv12*t + jac_inv13*(-4.0*r - 4.0*s - 8.0*t + 4.0), 0, 0, 4.0*jac_inv11*s + 4.0*jac_inv12*r, 0, 0, 4.0*jac_inv12*t + 4.0*jac_inv13*s, 0, 0, 4.0*jac_inv11*t + 4.0*jac_inv13*r, 0, 0], [0, jac_inv21*(4.0*r + 4.0*s + 4.0*t - 3.0) + jac_inv22*(4.0*r + 4.0*s + 4.0*t - 3.0) + jac_inv23*(4.0*r + 4.0*s + 4.0*t - 3.0), 0, 0, jac_inv21*(4.0*r - 1.0), 0, 0, jac_inv22*(4.0*s - 1.0), 0, 0, jac_inv23*(4.0*t - 1.0), 0, 0, jac_inv21*(-8.0*r - 4.0*s - 4.0*t + 4.0) - 4.0*jac_inv22*r - 4.0*jac_inv23*r, 0, 0, -4.0*jac_inv21*s + jac_inv22*(-4.0*r - 8.0*s - 4.0*t + 4.0) - 4.0*jac_inv23*s, 0, 0, -4.0*jac_inv21*t - 4.0*jac_inv22*t + jac_inv23*(-4.0*r - 4.0*s - 8.0*t + 4.0), 0, 0, 4.0*jac_inv21*s + 4.0*jac_inv22*r, 0, 0, 4.0*jac_inv22*t + 4.0*jac_inv23*s, 0, 0, 4.0*jac_inv21*t + 4.0*jac_inv23*r, 0], [0, 0, jac_inv31*(4.0*r + 4.0*s + 4.0*t - 3.0) + jac_inv32*(4.0*r + 4.0*s + 4.0*t - 3.0) + jac_inv33*(4.0*r + 4.0*s + 4.0*t - 3.0), 0, 0, jac_inv31*(4.0*r - 1.0), 0, 0, jac_inv32*(4.0*s - 1.0), 0, 0, jac_inv33*(4.0*t - 1.0), 0, 0, jac_inv31*(-8.0*r - 4.0*s - 4.0*t + 4.0) - 4.0*jac_inv32*r - 4.0*jac_inv33*r, 0, 0, -4.0*jac_inv31*s + jac_inv32*(-4.0*r - 8.0*s - 4.0*t + 4.0) - 4.0*jac_inv33*s, 0, 0, -4.0*jac_inv31*t - 4.0*jac_inv32*t + jac_inv33*(-4.0*r - 4.0*s - 8.0*t + 4.0), 0, 0, 4.0*jac_inv31*s + 4.0*jac_inv32*r, 0, 0, 4.0*jac_inv32*t + 4.0*jac_inv33*s, 0, 0, 4.0*jac_inv31*t + 4.0*jac_inv33*r], [0, jac_inv31*(4.0*r + 4.0*s + 4.0*t - 3.0) + jac_inv32*(4.0*r + 4.0*s + 4.0*t - 3.0) + jac_inv33*(4.0*r + 4.0*s + 4.0*t - 3.0), jac_inv21*(4.0*r + 4.0*s + 4.0*t - 3.0) + jac_inv22*(4.0*r + 4.0*s + 4.0*t - 3.0) + jac_inv23*(4.0*r + 4.0*s + 4.0*t - 3.0), 0, jac_inv31*(4.0*r - 1.0), jac_inv21*(4.0*r - 1.0), 0, jac_inv32*(4.0*s - 1.0), jac_inv22*(4.0*s - 1.0), 0, jac_inv33*(4.0*t - 1.0), jac_inv23*(4.0*t - 1.0), 0, jac_inv31*(-8.0*r - 4.0*s - 4.0*t + 4.0) - 4.0*jac_inv32*r - 4.0*jac_inv33*r, jac_inv21*(-8.0*r - 4.0*s - 4.0*t + 4.0) - 4.0*jac_inv22*r - 4.0*jac_inv23*r, 0, -4.0*jac_inv31*s + jac_inv32*(-4.0*r - 8.0*s - 4.0*t + 4.0) - 4.0*jac_inv33*s, -4.0*jac_inv21*s + jac_inv22*(-4.0*r - 8.0*s - 4.0*t + 4.0) - 4.0*jac_inv23*s, 0, -4.0*jac_inv31*t - 4.0*jac_inv32*t + jac_inv33*(-4.0*r - 4.0*s - 8.0*t + 4.0), -4.0*jac_inv21*t - 4.0*jac_inv22*t + jac_inv23*(-4.0*r - 4.0*s - 8.0*t + 4.0), 0, 4.0*jac_inv31*s + 4.0*jac_inv32*r, 4.0*jac_inv21*s + 4.0*jac_inv22*r, 0, 4.0*jac_inv32*t + 4.0*jac_inv33*s, 4.0*jac_inv22*t + 4.0*jac_inv23*s, 0, 4.0*jac_inv31*t + 4.0*jac_inv33*r, 4.0*jac_inv21*t + 4.0*jac_inv23*r], [jac_inv31*(4.0*r + 4.0*s + 4.0*t - 3.0) + jac_inv32*(4.0*r + 4.0*s + 4.0*t - 3.0) + jac_inv33*(4.0*r + 4.0*s + 4.0*t - 3.0), 0, jac_inv11*(4.0*r + 4.0*s + 4.0*t - 3.0) + jac_inv12*(4.0*r + 4.0*s + 4.0*t - 3.0) + jac_inv13*(4.0*r + 4.0*s + 4.0*t - 3.0), jac_inv31*(4.0*r - 1.0), 0, jac_inv11*(4.0*r - 1.0), jac_inv32*(4.0*s - 1.0), 0, jac_inv12*(4.0*s - 1.0), jac_inv33*(4.0*t - 1.0), 0, jac_inv13*(4.0*t - 1.0), jac_inv31*(-8.0*r - 4.0*s - 4.0*t + 4.0) - 4.0*jac_inv32*r - 4.0*jac_inv33*r, 0, jac_inv11*(-8.0*r - 4.0*s - 4.0*t + 4.0) - 4.0*jac_inv12*r - 4.0*jac_inv13*r, -4.0*jac_inv31*s + jac_inv32*(-4.0*r - 8.0*s - 4.0*t + 4.0) - 4.0*jac_inv33*s, 0, -4.0*jac_inv11*s + jac_inv12*(-4.0*r - 8.0*s - 4.0*t + 4.0) - 4.0*jac_inv13*s, -4.0*jac_inv31*t - 4.0*jac_inv32*t + jac_inv33*(-4.0*r - 4.0*s - 8.0*t + 4.0), 0, -4.0*jac_inv11*t - 4.0*jac_inv12*t + jac_inv13*(-4.0*r - 4.0*s - 8.0*t + 4.0), 4.0*jac_inv31*s + 4.0*jac_inv32*r, 0, 4.0*jac_inv11*s + 4.0*jac_inv12*r, 4.0*jac_inv32*t + 4.0*jac_inv33*s, 0, 4.0*jac_inv12*t + 4.0*jac_inv13*s, 4.0*jac_inv31*t + 4.0*jac_inv33*r, 0, 4.0*jac_inv11*t + 4.0*jac_inv13*r], [jac_inv21*(4.0*r + 4.0*s + 4.0*t - 3.0) + jac_inv22*(4.0*r + 4.0*s + 4.0*t - 3.0) + jac_inv23*(4.0*r + 4.0*s + 4.0*t - 3.0), jac_inv11*(4.0*r + 4.0*s + 4.0*t - 3.0) + jac_inv12*(4.0*r + 4.0*s + 4.0*t - 3.0) + jac_inv13*(4.0*r + 4.0*s + 4.0*t - 3.0), 0, jac_inv21*(4.0*r - 1.0), jac_inv11*(4.0*r - 1.0), 0, jac_inv22*(4.0*s - 1.0), jac_inv12*(4.0*s - 1.0), 0, jac_inv23*(4.0*t - 1.0), jac_inv13*(4.0*t - 1.0), 0, jac_inv21*(-8.0*r - 4.0*s - 4.0*t + 4.0) - 4.0*jac_inv22*r - 4.0*jac_inv23*r, jac_inv11*(-8.0*r - 4.0*s - 4.0*t + 4.0) - 4.0*jac_inv12*r - 4.0*jac_inv13*r, 0, -4.0*jac_inv21*s + jac_inv22*(-4.0*r - 8.0*s - 4.0*t + 4.0) - 4.0*jac_inv23*s, -4.0*jac_inv11*s + jac_inv12*(-4.0*r - 8.0*s - 4.0*t + 4.0) - 4.0*jac_inv13*s, 0, -4.0*jac_inv21*t - 4.0*jac_inv22*t + jac_inv23*(-4.0*r - 4.0*s - 8.0*t + 4.0), -4.0*jac_inv11*t - 4.0*jac_inv12*t + jac_inv13*(-4.0*r - 4.0*s - 8.0*t + 4.0), 0, 4.0*jac_inv21*s + 4.0*jac_inv22*r, 4.0*jac_inv11*s + 4.0*jac_inv12*r, 0, 4.0*jac_inv22*t + 4.0*jac_inv23*s, 4.0*jac_inv12*t + 4.0*jac_inv13*s, 0, 4.0*jac_inv21*t + 4.0*jac_inv23*r, 4.0*jac_inv11*t + 4.0*jac_inv13*r, 0]])

